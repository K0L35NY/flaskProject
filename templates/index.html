<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="../static/style.css">
    <title>BetterToDo</title>
    <style>

    </style>
</head>

<body>

    <div id="top-bar">
        <div id="date">
            <span class="formatted-date">{{ formatted_date }}</span>
            <span class="current-year">{{ current_year }}</span>
        </div>
        <div id="account">
            {% if username %}
            <span class="username">Welcome, {{ username }}!</span>
            <a href="{{ url_for('logout') }}" class="logout-button">Logout</a>
            {% endif %}
        </div>
    </div>

    <div id="calendar">
        <div id="weekdays">
            <div class="name">Mon</div>
            <div class="name">Tue</div>
            <div class="name">Wed</div>
            <div class="name">Thu</div>
            <div class="name">Fri</div>
            <div class="weekend">Sat</div>
            <div class="weekend">Sun</div>
        </div>
        <div id="month-view">
            {% for week in calendar_data.days_in_month %}
            {% for day in week %}
            {% if day %}
            {% if day == calendar_data.current_day %}
            <div class="day current-day">{{ day }}</div>
            {% else %}
            <div class="day">{{ day }}</div>
            {% endif %}
            {% else %}
            <div class="day"></div>
            {% endif %}
            {% endfor %}
            {% endfor %}
        </div>
    </div>

    <h1>ToDo App</h1>

    <form method="POST" action="/add_task">
        <input type="text" name="title" placeholder="Title">
        <input type="text" name="description" placeholder="Description">
        <input type="date" name="day">
        <input type="submit" value="Add Task">
    </form>
    <h2>Tu na dole są taski do edytowiania i usuwania, fajnie by było to zrobić że jest przycisk obok taska, żeby go
        albo zedytować albo usunąć. Fajnie jakby edytowanie było by w innej stronie albo w jakims pop-upie. </h2>
    {% for task in tasks %}

    <div>
        <h2>{{ task.title }}</h2>
        <p>{{ task.description }}</p>
        <p>{{ task.day }}</p>
        <form method="POST" action="/edit_task/{{ task.id }}">
            <input type="text" name="title" value="{{ task.title }}">
            <input type="text" name="description" value="{{ task.description }}">
            <input type="text" name="day" value="{{ task.day }}">
            <input type="submit" value="Edit Task">
        </form>
        <a href="/delete_task/{{ task.id }}">Delete</a>
    </div>
    {% endfor %}

    <h2>To jest lista tasków taka żeby była ładna. Gdy w liście dzisiejszych i pozostałych tasków nie ma nic, to
        fajnie jakbyście zrobili jakis napis, że nic do roboty czy cos :)</h2>
    <h2>Today's Tasks</h2>
        {% for task in tasks_today %}
            <p>{{ task.title }}</p>
            <p>{{ task.description }}</p>
        {% endfor %}

    <h2>Remaining Tasks</h2>
        {% for task in tasks_remaining %}
            <p>{{ task.day }}</p>
            <p>{{ task.title }}</p>
            <p>{{ task.description }}</p>
        {% endfor %}

    <div class="tracker-container">
        <header>
            <h1>Track your 1st week</h1>
            <button class="addHabitButton">Add Habit</button>
        </header>
        <table class="habit-tracker">
            <thead>
              <tr>
                <th>Habit</th>
                <th>Goal</th>
                {% for day in ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'] %}
                  <th>{{ day }}</th>
                {% endfor %}
                <th>Progress</th>
              </tr>
            </thead>
            <tbody>
              {% for habit in habits %}
                <tr>
                    <td>{{ habit.habit_name }}</td>
                    <td>{{ habit.goal_days }} days/week</td>
                    {% for day in ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'] %}
                        {% set log = habit_tracking_data[habit.id]['logs'].get(loop.index, 0) %}
                        <td>
                           <input
                               type="checkbox"
                               data-habit-id="{{ habit.id }}"
                               data-day-index="{{ loop.index }}"
                               {% if (habit.id, loop.index) in checkbox_states and checkbox_states[(habit.id, loop.index)] %}checked{% endif %}
                           >
                        </td>
                    {% endfor %}
                    <td class="progress habit-{{ habit.id }}-progress">0%</td>
                </tr>
            </tbody>
          {% endfor %}
        </table>
    </div>

    <div id="addHabitModal" class="modal">
      <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>
        <form action="{{ url_for('add_habit') }}" method="post">
          <label for="habit_name">Habit Name:</label>
          <input type="text" id="habit_name" name="habit_name" required>
          <label for="goal_days">Goal Days:</label>
          <select id="goal_days" name="goal_days" required>
            {% for i in range(1, 8) %}
              <option value="{{ i }}">{{ i }} days/week</option>
            {% endfor %}
          </select>
          <input type="submit" value="Add Habit">
        </form>
      </div>
    </div>

    <script src="../static/script.js"></script>
</body>

</html>
